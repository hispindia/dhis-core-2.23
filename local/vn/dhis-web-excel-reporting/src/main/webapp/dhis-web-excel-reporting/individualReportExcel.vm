<h3>$i18n.getString( "individual_report" ) #openHelp( "excelReportingIndividualReport" )</h3>
<div id="tooltip"></div>

<form id="editDataSetForm" name="editDataSetForm" method="post" onsubmit="submitForm(); return validateEditDataSet()">
  <div style="display:inline">
  <input type="hidden" id="dataSetId" name="dataSetId" value="$dataSet.id">
  </div>
  
  <table id="detailsList">
    <col> ## Labels
    <col> ## Input
    <thead>
    </thead>
    <tbody>
     
      <tr>
        <td>
          <!--
            Combobox with all available period types (registration frequencies.
          -->
        </td>
      </tr>	  
      
    </tbody>
  </table>

  <table id="dataElementSelectionArea">
    <col> ## Available DataElements
    <col> ## Filter
    <col> ## Selected DataElements
    <thead>
	  <tr>
	  	<th colspan="3"><strong>Select data element</strong></th>
	  </tr>
	  <tr>
	    <td colspan="3">&nbsp;</td>
      </tr>
      <tr>
        <th>$i18n.getString( "available_data_elements" )</th>
		<th>$i18n.getString( "filter" )</th>
        <th>$i18n.getString( "selected_data_elements" )</th>
      </tr>
    </thead>
    <tbody>
    	
      <tr>
        <td>
          <select id="availabeldataElementGroups" name="availabeldataElementGroups" style="width:30em ; z-index:0"
              onchange="javascript:filterByDataElementGroup( this.options[this.selectedIndex].value )">
            <option value="ALL" selected="selected">$i18n.getString( "all" )</option>
            #foreach ( $dataElementGroup in $dataElementGroups )
              <option value="$dataElementGroup.id" >$encoder.htmlEncode( $dataElementGroup.name )</option>
            #end
          </select>
        </td>
        <td>&nbsp;</td>
        <td></td>
      </tr>
      
      <tr>
        <td><input type="text" id="availableDataElementsFilter" name="availableDataElementsFilter" onKeyUp="filterAvailableDataElements()" style="width:30em"> </td>
        <td>&nbsp;</td>
      	<td><input type="text" id="dataSetMembersFilter"  name="dataSetMembersFilter" onkeyup="filterDataSetMembers()" style="max-width:30em;min-width:30em"></td>        
      </tr>
      
      <tr>
        <td>
          <!-- List of all available DataElements -->
		 
          <select size="15"  onMouseOut="javascript: hideToolTip();" id="availableDataElements" name="availableDataElements" style="max-width:30em;min-width:30em;height:10em" onChange="getOptionCombos();">
          </select>
		  <br><br>
		  <strong>$i18n.getString('category_option_combo')</strong><br>
		  <select size="15" id="availableOptionCombos" name="availableOptionCombos" style="max-width:30em;min-width:30em;height:10em" ondblclick="addDataSetMembers();">
          </select>
</td>
        <td>
          <input type="button" value="&gt;" title="$i18n.getString('move_selected')" onclick="addDataSetMembers();">
          <br>
          <input type="button" value="&lt;" title="$i18n.getString('remove_selected')" onclick="removeDataSetMembers();">
        </td>
        <td>
          <!-- List of all selected DataElements -->
          <select  size="15" onMouseOut="javascript: hideToolTip();" id="selectedDataElements" name="selectedDataElements" style="max-width:30em;min-width:30em;height:22em" ondblclick="removeDataSetMembers();">
          </select>
        </td>
      </tr>
	  <tr>
	    <td>&nbsp;</td>
      </tr>
	  <tr>
	  	<th colspan="3">Select period</th>
	  </tr>
	  <tr>
	    <td colspan="3">&nbsp;</td>
      </tr>
	  <tr>
        <th>$i18n.getString( "available_periods" )</th>
		<th>$i18n.getString( "filter" )</th>
        <th>$i18n.getString( "selected_periods" )</th>
      </tr>
		<tr>
        <td>
          <select id="availabelPeriodTypes" name="availabelPeriodTypes" style="width:30em ;" onChange="javascript: getPeriodsByPeriodTypeName();">
           
            #foreach ( $periodType in $periodTypes )
              
            <option value="$periodType.name" >$i18n.getString( $periodType.name )</option>
            
            #end
          
          </select>
        </td>
        <td>&nbsp;</td>
        <td></td>
      </tr>
      <tr>
		<td><input name="button_previous" type="button" title="$i18n.getString('earlier_periods')" onClick="javascript: lastPeriod();" value="&lt;&lt;" #if( $periods.size() == 0 ) #end>	      
		<input name="button_later" type="button" title="$i18n.getString('later_periods')" onclick="javascript: nextPeriod();" value="&gt;&gt;" #if( $periods.size() == 0 ) #end></td>
		<td>&nbsp;</td>
	  </tr>
	  <tr>
        <td>
          <!-- List of all available DataElements -->
          <select size="15" id="availablePeriods" name="availablePeriods" multiple="multiple" style="max-width:30em;min-width:30em;height:20em" ondblclick="moveSelectedById( 'availablePeriods', 'selectedPeriods' );">
          
		  </select>
</td>
        <td>
          <input type="button" value="&gt;" title="$i18n.getString('move_selected')" onclick="moveSelectedById( 'availablePeriods', 'selectedPeriods' );">
          <br>
          <input type="button" value="&lt;" title="$i18n.getString('remove_selected')" onclick="moveSelectedById( 'selectedPeriods', 'availablePeriods' );">
        </td>
        <td>
          <!-- List of all selected DataElements -->
          <select id="selectedPeriods" name="selectedPeriods" multiple="multiple" style="max-width:30em;min-width:30em;height:20em" ondblclick="moveSelectedById( 'selectedPeriods', 'availablePeriods' );">
          </select>
        </td>
      </tr>
	  
      <tr>
        <td colspan="3">
          <input type="button" value="$i18n.getString( "generate" )" style="width:10em" onClick="generateIndividualReportExcel();">
		  <!--input type="button" value="$i18n.getString( "bookmark" )" style="width:10em"-->
        </td>
      </tr>
      
    </tbody>
  </table>
</form>
<span id="message"></span>
<span id="loading" style="display:none;position:fixed;"><img src="../images/ajax-loader.gif" /></span>

<script type="text/javascript">

	var dataSetMembers = new Object();
	
	var availableAllDataElements = new Object();	
	#foreach ( $availableDataElement in $dataElements )
		availableAllDataElements['$availableDataElement.id'] = '$encoder.jsEscape( $availableDataElement.name, "'" )';
	#end

	initLists();
	
	getPeriodsByPeriodTypeName();
	
	var i18n_choose_period = '$encoder.jsEscape($i18n.getString( 'choose_period' ) , "'")';
	var i18n_choose_dataelement = '$encoder.jsEscape($i18n.getString( 'choose_dataelement' ) , "'")';

</script>
